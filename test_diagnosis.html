<!DOCTYPE html>
<html>
<head>
    <title>æŒ‘æˆ˜è¯Šæ–­æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .challenge { border: 2px solid #ccc; margin: 15px 0; padding: 15px; border-radius: 8px; }
        .progress-bar { width: 300px; height: 25px; background: #f0f0f0; border-radius: 12px; overflow: hidden; margin: 10px 0; }
        .progress { height: 100%; background: linear-gradient(90deg, #4CAF50, #8BC34A); width: 0%; transition: width 0.3s; }
        button { margin: 5px; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; }
        .test-btn { background: #2196F3; color: white; }
        .fix-btn { background: #FF9800; color: white; }
        .status { background: #e3f2fd; padding: 10px; margin: 10px 0; border-radius: 5px; }
        .problem { color: #f44336; font-weight: bold; }
        .success { color: #4CAF50; font-weight: bold; }
    </style>
</head>
<body>
    <h1>ğŸ¯ æŒ‘æˆ˜è¯Šæ–­æµ‹è¯•é¡µé¢</h1>
    <p>è¿™ä¸ªé¡µé¢æ¼”ç¤ºäº†æ‰€æœ‰æŒ‘æˆ˜çš„<strong>æ ¸å¿ƒé—®é¢˜</strong>ï¼š<span class="problem">æ•°æ®æ›´æ–°æ­£å¸¸ï¼Œä½†æ˜¾ç¤ºä¸æ›´æ–°ï¼</span></p>
    
    <div id="challenge1" class="challenge">
        <h3>ğŸ–±ï¸ æŒ‘æˆ˜1-æ‘¸é±¼æ–°æ‰‹</h3>
        <p>ç›®æ ‡ï¼šç‚¹å‡»100æ¬¡é‡‘å¸ | å¥–åŠ±ï¼š500é‡‘å¸</p>
        <div class="progress-bar">
            <div id="progress1" class="progress"></div>
        </div>
        <div id="progressText1">0/100</div>
        <button id="claim1" disabled>é¢†å–</button>
    </div>
    
    <div id="challenge2" class="challenge">
        <h3>â° æŒ‘æˆ˜2-æ—¶é—´ç®¡ç†å¤§å¸ˆ</h3>
        <p>ç›®æ ‡ï¼šåœ¨çº¿30åˆ†é’Ÿ | å¥–åŠ±ï¼š1000é‡‘å¸</p>
        <div class="progress-bar">
            <div id="progress2" class="progress"></div>
        </div>
        <div id="progressText2">0/1800000</div>
        <button id="claim2" disabled>é¢†å–</button>
    </div>
    
    <div id="challenge3" class="challenge">
        <h3>ğŸ¯ æŒ‘æˆ˜3-ç²¾å‡†ç‚¹å‡»</h3>
        <p>ç›®æ ‡ï¼šæˆåŠŸç‚¹å‡»80æ¬¡ | å¥–åŠ±ï¼š800é‡‘å¸</p>
        <div class="progress-bar">
            <div id="progress3" class="progress"></div>
        </div>
        <div id="progressText3">0/80</div>
        <button id="claim3" disabled>é¢†å–</button>
    </div>
    
    <div style="margin: 20px 0;">
        <button class="test-btn" onclick="testClick()">ğŸ–±ï¸ æ¨¡æ‹Ÿç‚¹å‡»é‡‘å¸ï¼ˆæŒ‘æˆ˜1ï¼‰</button>
        <button class="test-btn" onclick="testAccuracy()">ğŸ¯ æ¨¡æ‹Ÿç²¾å‡†ç‚¹å‡»ï¼ˆæŒ‘æˆ˜3ï¼‰</button>
        <button class="test-btn" onclick="testTime()">â° æ¨¡æ‹Ÿæ—¶é—´å¢åŠ ï¼ˆæŒ‘æˆ˜2ï¼‰</button>
        <button class="fix-btn" onclick="showRealStatus()">ğŸ“Š æ˜¾ç¤ºçœŸå®çŠ¶æ€</button>
        <button class="fix-btn" onclick="applyQuickFix()">ğŸ”§ åº”ç”¨å¿«é€Ÿä¿®å¤</button>
    </div>
    
    <div id="output" class="status"></div>
    
    <script>
        // æ¨¡æ‹ŸçœŸå®çš„æŒ‘æˆ˜æ•°æ®
        window.dailyChallenges = [
            {
                id: 'click_100',
                title: 'æ‘¸é±¼æ–°æ‰‹',
                type: 'click',
                progress: 0,
                target: 100,
                reward: 500,
                completed: false,
                claimed: false
            },
            {
                id: 'time_30min',
                title: 'æ—¶é—´ç®¡ç†å¤§å¸ˆ', 
                type: 'time',
                progress: 0,
                target: 1800000,
                reward: 1000,
                completed: false,
                claimed: false
            },
            {
                id: 'accuracy_80',
                title: 'ç²¾å‡†ç‚¹å‡»',
                type: 'accuracy',
                progress: 0,
                target: 80,
                reward: 800,
                completed: false,
                claimed: false
            }
        ];
        
        // âŒ è¿™æ˜¯åŸå§‹çš„æœ‰é—®é¢˜çš„å‡½æ•° - åªæ›´æ–°æ•°æ®ï¼Œä¸æ›´æ–°æ˜¾ç¤ºï¼
        window.updateChallengeProgress = function(type, value = 1) {
            console.log(`ğŸ”„ updateChallengeProgressè¢«è°ƒç”¨ - ç±»å‹: ${type}, å€¼: ${value}`);
            
            let updated = false;
            
            dailyChallenges.forEach(challenge => {
                if (challenge.type === type && !challenge.completed) {
                    console.log(`ğŸ“Š å¤„ç†æŒ‘æˆ˜: ${challenge.title} (${challenge.id})`);
                    
                    const originalProgress = challenge.progress;
                    
                    if (type === 'click') {
                        challenge.progress += value;
                    } else if (type === 'time') {
                        challenge.progress = Math.min(challenge.progress + value, challenge.target);
                    } else if (type === 'accuracy') {
                        challenge.progress += value;
                    }
                    
                    console.log(`ğŸ“ˆ è¿›åº¦æ›´æ–°: ${originalProgress} â†’ ${challenge.progress}/${challenge.target}`);
                    
                    if (challenge.progress >= challenge.target) {
                        challenge.completed = true;
                        console.log(`ğŸ‰ æŒ‘æˆ˜å®Œæˆ: ${challenge.title}!`);
                    }
                    
                    updated = true;
                }
            });
            
            // âŒ é—®é¢˜å°±åœ¨è¿™é‡Œï¼åªä¿å­˜æ•°æ®ï¼Œä¸æ›´æ–°DOMæ˜¾ç¤º
            if (updated) {
                console.log('ğŸ’¾ ä¿å­˜æŒ‘æˆ˜æ•°æ®åˆ°localStorage');
                localStorage.setItem('dailyChallenges', JSON.stringify(dailyChallenges));
                console.log('âš ï¸  æ³¨æ„ï¼šæœªæ›´æ–°DOMæ˜¾ç¤º - è¿™å°±æ˜¯é—®é¢˜æ‰€åœ¨ï¼');
            }
            
            return updated;
        };
        
        // æµ‹è¯•å‡½æ•°
        window.testClick = function() {
            console.log('\nğŸ§ª æµ‹è¯•æŒ‘æˆ˜1ï¼ˆç‚¹å‡»ï¼‰...');
            updateChallengeProgress('click', 1);
            addOutput('ğŸ–±ï¸ ç‚¹å‡»æµ‹è¯• - æ•°æ®å·²æ›´æ–°ï¼ˆä½†æ˜¾ç¤ºæœªå˜ï¼‰', 'problem');
        };
        
        window.testAccuracy = function() {
            console.log('\nğŸ§ª æµ‹è¯•æŒ‘æˆ˜3ï¼ˆç²¾å‡†ï¼‰...');
            updateChallengeProgress('accuracy', 1);
            addOutput('ğŸ¯ ç²¾å‡†æµ‹è¯• - æ•°æ®å·²æ›´æ–°ï¼ˆä½†æ˜¾ç¤ºæœªå˜ï¼‰', 'problem');
        };
        
        window.testTime = function() {
            console.log('\nğŸ§ª æµ‹è¯•æŒ‘æˆ˜2ï¼ˆæ—¶é—´ï¼‰...');
            updateChallengeProgress('time', 10000);
            addOutput('â° æ—¶é—´æµ‹è¯• - æ•°æ®å·²æ›´æ–°ï¼ˆä½†æ˜¾ç¤ºæœªå˜ï¼‰', 'problem');
        };
        
        // æ˜¾ç¤ºçœŸå®çŠ¶æ€ï¼ˆæ•°æ® vs æ˜¾ç¤ºå¯¹æ¯”ï¼‰
        window.showRealStatus = function() {
            console.log('\nğŸ“Š æ˜¾ç¤ºçœŸå®çŠ¶æ€å¯¹æ¯”...');
            let html = '<h4>ğŸ” æ•°æ® vs æ˜¾ç¤ºå¯¹æ¯”ï¼š</h4>';
            
            dailyChallenges.forEach((challenge, index) => {
                const displayElement = document.getElementById(`progressText${index + 1}`);
                const displayText = displayElement ? displayElement.textContent : 'å…ƒç´ ä¸å­˜åœ¨';
                const dataText = `${challenge.progress}/${challenge.target}`;
                
                html += `<div style="margin: 10px 0; padding: 10px; background: ${dataText === displayText ? '#e8f5e8' : '#ffeaea'};">`;
                html += `<strong>æŒ‘æˆ˜${index + 1} (${challenge.id}):</strong><br>`;
                html += `ğŸ“Š å®é™…æ•°æ®: ${dataText}<br>`;
                html += `ğŸ–¥ï¸ é¡µé¢æ˜¾ç¤º: ${displayText}<br>`;
                html += `<span style="color: ${dataText === displayText ? '#4CAF50' : '#f44336'}">`;
                html += dataText === displayText ? 'âœ… åŒæ­¥æ­£å¸¸' : 'âŒ ä¸åŒæ­¥ - æ˜¾ç¤ºæœªæ›´æ–°ï¼';
                html += '</span></div>';
            });
            
            document.getElementById('output').innerHTML = html;
        };
        
        // âœ… å¿«é€Ÿä¿®å¤å‡½æ•° - åŒæ­¥æ˜¾ç¤º
        window.applyQuickFix = function() {
            console.log('\nğŸ”§ åº”ç”¨å¿«é€Ÿä¿®å¤...');
            
            dailyChallenges.forEach((challenge, index) => {
                const progressText = document.getElementById(`progressText${index + 1}`);
                const progressBar = document.getElementById(`progress${index + 1}`);
                const claimBtn = document.getElementById(`claim${index + 1}`);
                
                if (progressText) {
                    progressText.textContent = `${challenge.progress}/${challenge.target}`;
                }
                
                if (progressBar) {
                    const percentage = Math.min((challenge.progress / challenge.target) * 100, 100);
                    progressBar.style.width = `${percentage}%`;
                }
                
                if (claimBtn) {
                    if (challenge.completed && !challenge.claimed) {
                        claimBtn.disabled = false;
                        claimBtn.style.background = '#4CAF50';
                        claimBtn.textContent = 'é¢†å–å¥–åŠ±';
                    } else if (challenge.claimed) {
                        claimBtn.disabled = true;
                        claimBtn.style.background = '#9e9e9e';
                        claimBtn.textContent = 'å·²é¢†å–';
                    }
                }
            });
            
            addOutput('âœ… å¿«é€Ÿä¿®å¤å®Œæˆï¼æ˜¾ç¤ºå·²åŒæ­¥', 'success');
            showRealStatus(); // æ˜¾ç¤ºä¿®å¤åçš„å¯¹æ¯”
        };
        
        // è¾…åŠ©å‡½æ•°
        function addOutput(message, type = '') {
            const output = document.getElementById('output');
            const div = document.createElement('div');
            div.style.margin = '5px 0';
            div.style.padding = '8px';
            div.style.background = type === 'problem' ? '#ffebee' : '#e8f5e8';
            div.style.borderRadius = '4px';
            div.innerHTML = message;
            output.appendChild(div);
            
            // é™åˆ¶è¾“å‡ºæ•°é‡
            if (output.children.length > 5) {
                output.removeChild(output.firstChild);
            }
        }
        
        // åˆå§‹åŒ–æ˜¾ç¤º
        window.onload = function() {
            console.log('ğŸ¯ è¯Šæ–­æµ‹è¯•é¡µé¢å·²åŠ è½½');
            console.log('ğŸ’¡ ç‚¹å‡»æµ‹è¯•æŒ‰é’®æ¥æ¨¡æ‹Ÿé—®é¢˜ï¼Œç„¶åç‚¹å‡»"æ˜¾ç¤ºçœŸå®çŠ¶æ€"æŸ¥çœ‹æ•°æ®vsæ˜¾ç¤ºå¯¹æ¯”');
            showRealStatus();
        };
    </script>
</body>
</html>