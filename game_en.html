<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‘¸é±¼é‡‘å¸æ¸¸æˆ</title>
    <style>
        body { 
            margin: 0; 
            padding: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            font-family: Arial, sans-serif; 
            color: white;
            text-align: center;
            min-height: 100vh;
        }
        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }
        #coinCanvas { 
            border: 3px solid #ffd700; 
            border-radius: 15px; 
            background: linear-gradient(45deg, #1e3c72, #2a5298);
            cursor: pointer;
            margin: 20px auto;
            display: block;
            box-shadow: 0 4px 20px rgba(255,215,0,0.3);
        }
        .score-display {
            font-size: 24px;
            margin: 20px 0;
            padding: 15px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            display: inline-block;
        }
        .challenge-panel {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: left;
        }
        .challenge-item {
            display: flex;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
        }
        .challenge-icon {
            font-size: 24px;
            margin-right: 15px;
        }
        .challenge-progress {
            flex: 1;
            margin: 0 15px;
        }
        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #4CAF50, #45a049);
            transition: width 0.3s ease;
        }
        .challenge-reward {
            font-weight: bold;
            color: #ffd700;
        }
        .controls {
            margin: 20px 0;
        }
        .control-button {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 5px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        .control-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(76,175,80,0.4);
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>ğŸ® æ‘¸é±¼é‡‘å¸æ¸¸æˆ</h1>
        <div class="score-display">å½“å‰åˆ†æ•°: <span id="score">0</span></div>
        
        <canvas id="coinCanvas" width="800" height="600"></canvas>
        
        <div class="controls">
            <button class="control-button" onclick="startGame()">å¼€å§‹æ¸¸æˆ</button>
            <button class="control-button" onclick="pauseGame()">æš‚åœ</button>
            <button class="control-button" onclick="resetGame()">é‡ç½®</button>
            <button class="control-button" onclick="testClick()">æµ‹è¯•ç‚¹å‡»</button>
        </div>
        
        <div class="challenge-panel">
            <h3>ğŸ“‹ æ¯æ—¥æŒ‘æˆ˜</h3>
            <div id="challenges"></div>
        </div>
    </div>

    <script>
        // æ¸¸æˆçŠ¶æ€
        let score = 0;
        let coins = [];
        let gameRunning = false;
        let canvas, ctx;
        let dailyChallenges = [];
        let gameStartTime = Date.now();

        // åˆå§‹åŒ–
        window.onload = function() {
            canvas = document.getElementById('coinCanvas');
            ctx = canvas.getContext('2d');
            
            // åˆå§‹åŒ–æŒ‘æˆ˜
            initChallenges();
            updateChallengesDisplay();
            
            // è®¾ç½®ç”»å¸ƒç‚¹å‡»äº‹ä»¶
            canvas.addEventListener('click', handleCanvasClick);
            
            // å¼€å§‹æ¸¸æˆå¾ªç¯
            gameLoop();
        };

        // åˆå§‹åŒ–æŒ‘æˆ˜
        function initChallenges() {
            dailyChallenges = [
                {
                    id: 'click_100',
                    title: 'æ‘¸é±¼æ–°æ‰‹',
                    description: 'ç‚¹å‡»é‡‘å¸è¾¾åˆ°100æ¬¡',
                    icon: 'ğŸ¯',
                    target: 100,
                    reward: 500,
                    type: 'click',
                    progress: 0,
                    completed: false,
                    claimed: false
                },
                {
                    id: 'time_30min',
                    title: 'æ—¶é—´ç®¡ç†å¤§å¸ˆ',
                    description: 'ç´¯è®¡æ‘¸é±¼30åˆ†é’Ÿ',
                    icon: 'â°',
                    target: 30 * 60 * 1000,
                    reward: 1000,
                    type: 'time',
                    progress: 0,
                    completed: false,
                    claimed: false
                },
                {
                    id: 'accuracy_80',
                    title: 'ç²¾å‡†ç‚¹å‡»',
                    description: 'æˆåŠŸç‚¹å‡»é‡‘å¸80æ¬¡',
                    icon: 'ğŸ¯',
                    target: 80,
                    reward: 800,
                    type: 'accuracy',
                    progress: 0,
                    completed: false,
                    claimed: false
                }
            ];
            
            // ä»æœ¬åœ°å­˜å‚¨åŠ è½½è¿›åº¦
            loadChallengeProgress();
        }

        // æ›´æ–°æŒ‘æˆ˜æ˜¾ç¤º
        function updateChallengesDisplay() {
            const challengesDiv = document.getElementById('challenges');
            challengesDiv.innerHTML = '';
            
            dailyChallenges.forEach(challenge => {
                const progress = Math.min(challenge.progress, challenge.target);
                const percentage = (progress / challenge.target * 100).toFixed(1);
                
                const challengeDiv = document.createElement('div');
                challengeDiv.className = 'challenge-item';
                challengeDiv.innerHTML = `
                    <div class="challenge-icon">${challenge.icon}</div>
                    <div class="challenge-progress">
                        <div><strong>${challenge.title}</strong> - ${challenge.description}</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${percentage}%"></div>
                        </div>
                        <div>è¿›åº¦: ${progress}/${challenge.target} (${percentage}%)</div>
                    </div>
                    <div class="challenge-reward">å¥–åŠ±: ${challenge.reward}åˆ†</div>
                `;
                challengesDiv.appendChild(challengeDiv);
            });
        }

        // æ›´æ–°æŒ‘æˆ˜è¿›åº¦
        function updateChallengeProgress(type, amount) {
            let updated = false;
            
            dailyChallenges.forEach(challenge => {
                if (challenge.type === type && !challenge.completed) {
                    challenge.progress += amount;
                    
                    if (challenge.progress >= challenge.target) {
                        challenge.completed = true;
                        challenge.progress = challenge.target;
                        
                        // å‘æ”¾å¥–åŠ±
                        score += challenge.reward;
                        updateScore(0); // åªæ›´æ–°æ˜¾ç¤º
                        
                        console.log(`ğŸ‰ æŒ‘æˆ˜å®Œæˆ: ${challenge.title}! è·å¾—å¥–åŠ±: ${challenge.reward}åˆ†`);
                    }
                    
                    updated = true;
                }
            });
            
            if (updated) {
                saveChallengeProgress();
                updateChallengesDisplay();
                console.log(`ğŸ“Š æŒ‘æˆ˜è¿›åº¦æ›´æ–°: ${type} +${amount}`);
            }
        }

        // ä¿å­˜æŒ‘æˆ˜è¿›åº¦
        function saveChallengeProgress() {
            localStorage.setItem('dailyChallenges', JSON.stringify(dailyChallenges));
        }

        // åŠ è½½æŒ‘æˆ˜è¿›åº¦
        function loadChallengeProgress() {
            const saved = localStorage.getItem('dailyChallenges');
            if (saved) {
                dailyChallenges = JSON.parse(saved);
            }
        }

        // æ›´æ–°åˆ†æ•°
        function updateScore(points) {
            score += points;
            document.getElementById('score').textContent = score;
        }

        // å¤„ç†ç”»å¸ƒç‚¹å‡»
        function handleCanvasClick(e) {
            if (!gameRunning) return;
            
            const rect = canvas.getBoundingClientRect();
            const clickX = e.clientX - rect.left;
            const clickY = e.clientY - rect.top;
            
            let coinClicked = false;
            
            // æ£€æŸ¥æ˜¯å¦ç‚¹å‡»åˆ°é‡‘å¸
            for (let i = coins.length - 1; i >= 0; i--) {
                const coin = coins[i];
                const distance = Math.sqrt(Math.pow(clickX - coin.x, 2) + Math.pow(clickY - coin.y, 2));
                
                if (distance < coin.size) {
                    // ç‚¹å‡»åˆ°é‡‘å¸
                    coinClicked = true;
                    coins.splice(i, 1);
                    
                    // æ›´æ–°åˆ†æ•°å’ŒæŒ‘æˆ˜è¿›åº¦
                    updateScore(10);
                    updateChallengeProgress('click', 1);
                    updateChallengeProgress('accuracy', 1);
                    
                    console.log('ğŸ’° æˆåŠŸç‚¹å‡»é‡‘å¸ï¼åˆ†æ•°+10');
                    break;
                }
            }
            
            if (!coinClicked) {
                console.log('âŒ æœªç‚¹å‡»åˆ°é‡‘å¸');
            }
        }

        // ç”Ÿæˆé‡‘å¸
        function generateCoin() {
            if (!gameRunning) return;
            
            const coin = {
                x: Math.random() * (canvas.width - 40) + 20,
                y: Math.random() * (canvas.height - 40) + 20,
                size: 20,
                color: '#FFD700',
                rotation: 0
            };
            
            coins.push(coin);
        }

        // ç»˜åˆ¶é‡‘å¸
        function drawCoins() {
            coins.forEach(coin => {
                ctx.save();
                ctx.translate(coin.x, coin.y);
                ctx.rotate(coin.rotation);
                
                // ç»˜åˆ¶é‡‘å¸
                ctx.beginPath();
                ctx.arc(0, 0, coin.size, 0, Math.PI * 2);
                ctx.fillStyle = coin.color;
                ctx.fill();
                
                // æ·»åŠ å…‰æ³½æ•ˆæœ
                ctx.beginPath();
                ctx.arc(-coin.size/3, -coin.size/3, coin.size/3, 0, Math.PI * 2);
                ctx.fillStyle = 'rgba(255,255,255,0.6)';
                ctx.fill();
                
                ctx.restore();
                
                // æ—‹è½¬åŠ¨ç”»
                coin.rotation += 0.02;
            });
        }

        // æ¸¸æˆå¾ªç¯
        function gameLoop() {
            // æ¸…ç©ºç”»å¸ƒ
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ç»˜åˆ¶é‡‘å¸
            drawCoins();
            
            // æ›´æ–°æŒ‘æˆ˜æ—¶é—´
            if (gameRunning) {
                const elapsed = Date.now() - gameStartTime;
                updateChallengeProgress('time', elapsed);
                gameStartTime = Date.now(); // é‡ç½®æ—¶é—´åŸºå‡†
            }
            
            // ç»§ç»­å¾ªç¯
            requestAnimationFrame(gameLoop);
        }

        // å¼€å§‹æ¸¸æˆ
        function startGame() {
            gameRunning = true;
            gameStartTime = Date.now();
            console.log('ğŸ® æ¸¸æˆå¼€å§‹ï¼');
            
            // å®šæœŸç”Ÿæˆé‡‘å¸
            setInterval(() => {
                if (gameRunning && coins.length < 5) {
                    generateCoin();
                }
            }, 2000);
        }

        // æš‚åœæ¸¸æˆ
        function pauseGame() {
            gameRunning = false;
            console.log('â¸ï¸ æ¸¸æˆæš‚åœ');
        }

        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            score = 0;
            coins = [];
            gameRunning = false;
            updateScore(0);
            
            // é‡ç½®æŒ‘æˆ˜è¿›åº¦ï¼ˆä½†ä¿ç•™å·²å®Œæˆçš„å¥–åŠ±ï¼‰
            dailyChallenges.forEach(challenge => {
                if (!challenge.completed) {
                    challenge.progress = 0;
                }
            });
            
            saveChallengeProgress();
            updateChallengesDisplay();
            console.log('ğŸ”„ æ¸¸æˆé‡ç½®');
        }

        // æµ‹è¯•ç‚¹å‡»
        function testClick() {
            if (!gameRunning) {
                console.log('âŒ æ¸¸æˆæœªå¼€å§‹ï¼Œæ— æ³•æµ‹è¯•ç‚¹å‡»');
                return;
            }
            
            // åœ¨ç”»å¸ƒä¸­å¿ƒç”Ÿæˆä¸€ä¸ªæµ‹è¯•é‡‘å¸
            const testCoin = {
                x: canvas.width / 2,
                y: canvas.height / 2,
                size: 25,
                color: '#FF6B6B',
                rotation: 0
            };
            
            coins.push(testCoin);
            console.log('ğŸ§ª æµ‹è¯•é‡‘å¸å·²ç”Ÿæˆåœ¨ç”»å¸ƒä¸­å¿ƒï¼Œè¯·ç‚¹å‡»å®ƒæµ‹è¯•åŠŸèƒ½');
        }

        // æ§åˆ¶å°æ—¥å¿—
        console.log('ğŸ® æ‘¸é±¼é‡‘å¸æ¸¸æˆå·²åŠ è½½');
        console.log('ğŸ“‹ ä½¿ç”¨è¯´æ˜ï¼š');
        console.log('1. ç‚¹å‡»ã€å¼€å§‹æ¸¸æˆã€‘å¼€å§‹');
        console.log('2. ç‚¹å‡»é‡‘å¸è·å¾—åˆ†æ•°å’ŒæŒ‘æˆ˜è¿›åº¦');
        console.log('3. å®ŒæˆæŒ‘æˆ˜è·å¾—é¢å¤–å¥–åŠ±');
        console.log('4. ä½¿ç”¨ã€æµ‹è¯•ç‚¹å‡»ã€‘ç”Ÿæˆæµ‹è¯•é‡‘å¸');
        console.log('');
        console.log('ğŸ’¡ æŒ‘æˆ˜ç³»ç»Ÿï¼š');
        console.log('- æ‘¸é±¼æ–°æ‰‹ï¼šç‚¹å‡»100æ¬¡é‡‘å¸');
        console.log('- æ—¶é—´ç®¡ç†å¤§å¸ˆï¼šç´¯è®¡30åˆ†é’Ÿ');
        console.log('- ç²¾å‡†ç‚¹å‡»ï¼šæˆåŠŸç‚¹å‡»80æ¬¡é‡‘å¸');
    </script>
</body>
</html>